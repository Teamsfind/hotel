<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.kcsj.dao.TravelcostMapper" >
  <resultMap id="BaseResultMap" type="com.kcsj.pojo.Travelcost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    <id column="travelcost_id" property="travelcostId" jdbcType="INTEGER" />
    <result column="user_number" property="userNumber" jdbcType="INTEGER" />
    <result column="travelcost_type" property="travelcostType" jdbcType="VARCHAR" />
    <result column="travelcost_time" property="travelcostTime" jdbcType="TIMESTAMP" />
    <result column="travelcost_cost" property="travelcostCost" jdbcType="DOUBLE" />
    <result column="travelcost_status" property="travelcostStatus" jdbcType="INTEGER" />
    <result column="travelcost_remark" property="travelcostRemark" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    travelcost_id, user_number, travelcost_type, travelcost_time, travelcost_cost, travelcost_status, 
    travelcost_remark
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from travelcost
    where travelcost_id = #{travelcostId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    delete from travelcost
    where travelcost_id = #{travelcostId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.kcsj.pojo.Travelcost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    insert into travelcost (travelcost_id, user_number, travelcost_type, 
      travelcost_time, travelcost_cost, travelcost_status, 
      travelcost_remark)
    values (#{travelcostId,jdbcType=INTEGER}, #{userNumber,jdbcType=INTEGER}, #{travelcostType,jdbcType=VARCHAR}, 
      #{travelcostTime,jdbcType=TIMESTAMP}, #{travelcostCost,jdbcType=DOUBLE}, #{travelcostStatus,jdbcType=INTEGER}, 
      #{travelcostRemark,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.kcsj.pojo.Travelcost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    insert into travelcost
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="travelcostId != null" >
        travelcost_id,
      </if>
      <if test="userNumber != null" >
        user_number,
      </if>
      <if test="travelcostType != null" >
        travelcost_type,
      </if>
      <if test="travelcostTime != null" >
        travelcost_time,
      </if>
      <if test="travelcostCost != null" >
        travelcost_cost,
      </if>
      <if test="travelcostStatus != null" >
        travelcost_status,
      </if>
      <if test="travelcostRemark != null" >
        travelcost_remark,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="travelcostId != null" >
        #{travelcostId,jdbcType=INTEGER},
      </if>
      <if test="userNumber != null" >
        #{userNumber,jdbcType=INTEGER},
      </if>
      <if test="travelcostType != null" >
        #{travelcostType,jdbcType=VARCHAR},
      </if>
      <if test="travelcostTime != null" >
        #{travelcostTime,jdbcType=TIMESTAMP},
      </if>
      <if test="travelcostCost != null" >
        #{travelcostCost,jdbcType=DOUBLE},
      </if>
      <if test="travelcostStatus != null" >
        #{travelcostStatus,jdbcType=INTEGER},
      </if>
      <if test="travelcostRemark != null" >
        #{travelcostRemark,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.kcsj.pojo.Travelcost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    update travelcost
    <set >
      <if test="userNumber != null" >
        user_number = #{userNumber,jdbcType=INTEGER},
      </if>
      <if test="travelcostType != null" >
        travelcost_type = #{travelcostType,jdbcType=VARCHAR},
      </if>
      <if test="travelcostTime != null" >
        travelcost_time = #{travelcostTime,jdbcType=TIMESTAMP},
      </if>
      <if test="travelcostCost != null" >
        travelcost_cost = #{travelcostCost,jdbcType=DOUBLE},
      </if>
      <if test="travelcostStatus != null" >
        travelcost_status = #{travelcostStatus,jdbcType=INTEGER},
      </if>
      <if test="travelcostRemark != null" >
        travelcost_remark = #{travelcostRemark,jdbcType=VARCHAR},
      </if>
    </set>
    where travelcost_id = #{travelcostId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.kcsj.pojo.Travelcost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 06 22:05:22 CST 2018.
    -->
    update travelcost
    set user_number = #{userNumber,jdbcType=INTEGER},
      travelcost_type = #{travelcostType,jdbcType=VARCHAR},
      travelcost_time = #{travelcostTime,jdbcType=TIMESTAMP},
      travelcost_cost = #{travelcostCost,jdbcType=DOUBLE},
      travelcost_status = #{travelcostStatus,jdbcType=INTEGER},
      travelcost_remark = #{travelcostRemark,jdbcType=VARCHAR}
    where travelcost_id = #{travelcostId,jdbcType=INTEGER}
  </update>
  <select id="FindCountTravelCost" resultType="com.kcsj.entitl.Travelcost2">
  	select  t.travelcost_type as travelcostType,t.travelcost_time as travelcostTime,t.travelcost_cost as travelcostCost,u.user_username as userName,u.user_dpt as userDpt,u.user_dpt_jbn as userDptJbn,u.user_number as userNumber
  	from travelcost t,user u 
  	where travelcost_status='0' and t.user_number=u.user_number and DATE_FORMAT( t.travelcost_time , '%Y%m' )=DATE_FORMAT( now( ) , '%Y%m' ) order by travelcostCost;
  </select>
  
  <update id="UpTravelCost1" parameterType="java.lang.Integer">
  		update travelcost
  		set travelcost_status = '1'
  		where user_number = #{userNumber,jdbcType=INTEGER} and travelcost_status='0'
  </update>
  
  <update id="UpTravelCost2" parameterType="java.lang.Integer">
  		update travelcost
  		set travelcost_status = '2'
  		where user_number = #{userNumber,jdbcType=INTEGER} and travelcost_status='0'
  </update>
  
  <select id="selectAllCost"  parameterType="java.lang.Integer" resultType="java.lang.Double">
    select sum(IFNULL(travelcost_cost,0))
    from travelcost
    where user_number = #{usernumber,jdbcType=INTEGER} and DATE_FORMAT(travelcost_time, '%Y%m') = DATE_FORMAT( now() , '%Y%m') and travelcost_status = '1'
  </select>
</mapper>